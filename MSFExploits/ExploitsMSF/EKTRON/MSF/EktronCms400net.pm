package MSFExploits::Exploits::EKTRON::MSF::EktronCms400net;
# use parent qw(MSFExploits::Exploit MSFExploits::Services::EKTRON);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use Coro qw( async );

# # use MSFExploits::Functions::Basic;
# # use MSFExploits::Functions::Errors;
# # use MSFExploits::Functions::Content;

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   my ( $requester, $database ) = @_;

   my $name = "EktronCms400net";

   my $DETECTION = {

   };

my $EXPLOIT = {
  DESCRIPTION => "

          Ektron CMS400.NET is a web content management system based on .NET.

          This module tests for installations that are utilizing default

          passwords set by the vendor. Additionally, it has the ability

          to brute force user accounts. Note that Ektron CMS400.NET, by

          default, enforces account lockouts for regular user account

          after a number of failed attempts.

        ",
  MSF_MODULE => "ektron_cms400net",
  TITLE => "Ektron CMS400.NET Default Password Scanner",


  TYPE => 'MSF',
  PLATFORM => 'SCANNER',
  REQUESTS => {
    EXPLOIT2 => {
      METHOD       => 'GET',
      PATH   => '',
      PAYLOAD      => '',
      TEXT   => 'Sending Exploit #2 Request : [GET] ',
      HEADERS      => {
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
  },
   };

   return $class->SUPER::new($requester, $database, $name, $DETECTION, $EXPLOIT, @_);
}

return 1;
