my $EXPLOIT = {
  CVE => "CVE-2010-2709",
  DESCRIPTION => "

          This module exploits a stack buffer overflow in HP OpenView Network Node Manager 7.53.

        By sending a request containing a cookie longer than 5120 bytes, an attacker can overflow

        a stack buffer and execute arbitrary code.



        The vulnerable code is within the OvWwwDebug function. The static-sized stack buffer is

        declared within this function. When the vulnerability is triggered, the stack trace looks

        like the following:



          #0 ...

          #1 sprintf_new(local_stack_buf, fmt, cookie);

          #2 OvWwwDebug(\"   HTTP_COOKIE=%s\
\", cookie);

          #3 ?OvWwwInit\@\@YAXAAHQAPADPBD\@Z(x, x, x);

          #4 sub_405ee0(\"nnm\", \"webappmon\");



        No validation is done on the cookie argument. There are no stack cookies, so exploitation

        is easily achieved by overwriting the saved return address or SEH frame.



        The original advisory detailed an attack vector using the \"OvJavaLocale\" cookie being

        passed in a request to \"webappmon.exe\". Further research shows that several different

        cookie values, as well as several different CGI applications, can be used.

      '",
  MSF_MODULE => "hp_nnm_webappmon_ovjavalocale",
  OSVDB => 66932,
  REFERENCES => [
    "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02446520",
    "http://www.coresecurity.com/content/hp-nnm-ovjavalocale-buffer-overflow",
  ],

