my $EXPLOIT = {
  CVE => "CVE-2016-7547",
  DESCRIPTION => "

          This module exploits two vulnerabilities the Trend Micro Threat Discovery Appliance.

          The first is an authentication bypass vulnerability via a file delete in logoff.cgi

          which resets the admin password back to 'admin' upon a reboot (CVE-2016-7552).

          The second is a cmdi flaw using the timezone parameter in the admin_sys_time.cgi

          interface (CVE-2016-7547).



          Note: You have the option to use the authentication bypass or not since it requires

          that the server is rebooted. The password reset will render the authentication useless.

          Typically, if an administrator cant login, they will bounce the box. Therefore, this

          module performs a heartbeat request until the box is bounced and then attempts to login

          and to perform the command injection. This module has been tested on version 2.6.1062r1

          of the appliance.

      ",
  METHOD => "GET",
  MSF_MODULE => "trendmicro_threat_discovery_admin_sys_time_cmdi",
  PATH => "",
  PATHS => ["cgi-bin/about.cgi", ""],
  PAYLOAD => "?",
  REFERENCES => ["https://asciinema.org/a/112480"],
  TITLE => "Trend Micro Threat Discovery Appliance admin_sys_time.cgi Remote Command Execution",
  VARIABLES => {
    'AUTHBYPASS' =>       { DESCRIPTION => "", VALUE => "" },
    'PASSWORD' =>       {
  DESCRIPTION => "The password to authenticate with",
  VALUE => "admin",
},
    'PATH' =>       { DESCRIPTION => "The target URI", VALUE => "/" },
  },
