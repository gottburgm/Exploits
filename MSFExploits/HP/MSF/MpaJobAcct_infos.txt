my $EXPLOIT = {
  CVE => "CVE-2011-4166",
  DESCRIPTION => "

        This module exploits an arbitrary file upload vulnerability on HP Managed Printing

        Administration 2.6.3 and prior versions. The vulnerability exists in the UploadFiles()

        function from the MPAUploader.Uploader.1 control, loaded and used by the server.

        The function can be abused via directory traversal and null byte injection in order

        to achieve arbitrary file upload. In order to exploit successfully, a few conditions

        must be met. First, a writable location under the context of Internet Guest Account

        (IUSR_*) or Everyone is required. By default, this module will attempt to write to

        /hpmpa/userfiles/, but the WRITEWEBFOLDER option can be used to provide

        another writable path. Second, the writable path must also be readable by a browser,

        so this typically means a location under wwwroot. Finally, you cannot overwrite

        a file with the same name as the payload.

      ",
  METHOD => "GET",
  MSF_MODULE => "hp_mpa_job_acct",
  OSVDB => 78015,
  PATH => "userId=__USERID__&jobId=__JOBID__&",
  REFERENCES => [
    "https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03128469",
  ],
  TITLE => "HP Managed Printing Administration jobAcct Remote Command Execution",
  VARIABLES => {
    'JOBID' =>       { DESCRIPTION => "", VALUE => "" },
    'USERID' =>       { DESCRIPTION => "", VALUE => "" },
  },
