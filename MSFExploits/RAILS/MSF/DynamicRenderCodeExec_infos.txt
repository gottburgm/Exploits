my $EXPLOIT = {
  CVE => "CVE-2016-0752",
  DESCRIPTION => "

        This module exploits a remote code execution vulnerability in the explicit render

        method when leveraging user parameters.

        This module has been tested across multiple versions of Ruby on Rails.

        The technique used by this module requires the specified

        endpoint to be using dynamic render paths, such as the following example:



        def show

          render params[:id]

        end



        Also, the vulnerable target will need a POST endpoint for the TempFile upload, this

        can literally be any endpoint. This module doesnt use the log inclusion method of

        exploitation due to it not being universal enough. Instead, a new code injection

        technique was found and used whereby an attacker can upload temporary image files

        against any POST endpoint and use them for the inclusion attack. Finally, you only

        get one shot at this if you are testing with the builtin rails server, use caution.

      ",
  METHOD => "GET",
  MSF_MODULE => "rails_dynamic_render_code_exec",
  REFERENCES => [
    "https://groups.google.com/forum/#!topic/rubyonrails-security/335P1DcLG00",
    "https://nvisium.com/blog/2016/01/26/rails-dynamic-render-to-rce-cve-2016-0752/",
    "https://gist.github.com/forced-request/5158759a6418e6376afb",
  ],
  TITLE => "Ruby on Rails Dynamic Render File Upload Remote Code Execution",
  VARIABLES => {
    'RHOST' =>       { DESCRIPTION => "", VALUE => "" },
    'FN' =>       { DESCRIPTION => "", VALUE => "" },
    'SRVHOST' =>       { DESCRIPTION => "", VALUE => "" },
    'SRVPORT' =>       { DESCRIPTION => "", VALUE => "" },
    'RPORT' =>       { DESCRIPTION => "", VALUE => "" },
    'CMD' =>       { DESCRIPTION => "", VALUE => "" },
    'UN' =>       { DESCRIPTION => "", VALUE => "" },
    'URIHOST' =>       { DESCRIPTION => "", VALUE => "" },
    'SSL' =>       { DESCRIPTION => "", VALUE => "" },
    'URIPATH' =>       { DESCRIPTION => "", VALUE => "" },
  },
