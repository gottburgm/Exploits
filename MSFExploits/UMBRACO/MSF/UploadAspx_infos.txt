my $EXPLOIT = {
  DESCRIPTION => "

          This module can be used to execute a payload on Umbraco CMS 4.7.0.378.

        The payload is uploaded as an ASPX script by sending a specially crafted

        SOAP request to codeEditorSave.asmx, which permits unauthorized file upload

        via the SaveDLRScript operation. SaveDLRScript is also subject to a path

        traversal vulnerability, allowing code to be placed into the web-accessible

        /umbraco/ directory.



        The module writes, executes and then overwrites an ASPX script; note that

        though the script content is removed, the file remains on the target. Automatic

        cleanup of the file is intended if a meterpreter payload is used.



        This module has been tested successfully on Umbraco CMS 4.7.0.378 on a Windows

        7 32-bit SP1. In this scenario, the \"IIS APPPOOL\\ASP.NET v4.0\" user must have

        write permissions on the Windows Temp folder.

      ",
  MSF_MODULE => "umbraco_upload_aspx",
  OSVDB => 83765,
  PATHS => ["umbraco/"],
  REFERENCES => [
    "http://blog.gdssecurity.com/labs/2012/7/3/find-bugs-faster-with-a-webmatrix-local-reference-instance.html",
    "http://umbraco.codeplex.com/workitem/18192",
  ],
  TITLE => "Umbraco CMS Remote Command Execution",
  VARIABLES => {
    'PATH' =>       {
  DESCRIPTION => "The URI path of the Umbraco login page",
  VALUE => "/umbraco/",
},
  },
